(function(n,t){n.module("directive.newTopic",[]).directive("newTopic",function(){return{replace:!0,restrict:"E",scope:{parent:"=",onAdd:"&"},templateUrl:"../templates/tmpl.directive.new-topic.html?1",controller:function(n,i){var u=i,r=this;n.currentStatus={id:0,text:"Ожидает"};n.newTopicId=0;n.isView={NewTopic:!1,NewLinks:!1};r.clearLink=function(){n.newLink={Title:"",Url:""}};r.clearTopic=function(){n.model={Title:"",Value:"",Connections:[],Links:[],Category:""}};n.switchView={Topic:function(){n.isView.NewTopic=!n.isView.NewTopic;n.model.Category||(n.model.Category=n.parent.Category)},Links:function(){n.isView.NewLinks=!n.isView.NewLinks}};r.checkModel=function(){if(n.currentStatus.text)n.model.Status=n.currentStatus.text;else return!1;return(n.parent.Id&&n.model.Connections.push(n.parent.Id),n.model.Title&&n.model.Value)?!0:!1};n.addTopic=function(){r.checkModel()&&(n.model.Created=new Date,n.model.Modified=new Date,u.topics.add(n.model).then(function(i){n.newTopicId=i;r.updateParentLink();r.clearTopic();n.isView.NewTopic=!1;t.success("New topic created!","Success")}))};n.addLink=function(){n.newLink.Title&&n.newLink.Url?(n.model.Links.push(n.newLink),r.clearLink()):t.error("Incorrect link!","Error")};r.updateParentLink=function(){n.parent.Connections.push(n.newTopicId);n.onAdd()};n.goToNewTopic=function(){window.location="../home/topic?id="+n.newTopicId};r.clearTopic();r.clearLink()}}})})(angular,toastr);
/*
//# sourceMappingURL=app.directives.min.js.map
*/